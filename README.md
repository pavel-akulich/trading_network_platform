# Онлайн платформа торговой сети электроники

**Russian** | [English](docs_eng/README.md)

## Описание проекта
Приложение "Онлайн платформа торговой сети электроники" представляет собой backend часть приложения, созданного на языке программирования Python с использованием Django REST framework.
Проект включает в себя backend-часть, ответственную за обработку данных и бизнес-логику.

## Составляющие части проекта

Проект состоит из следующих компонентов:

1. **Модели приложения**
    - Содержит три модели: `users`, `products`, `trading_networks`

2. **Админка**
    - Настроена админка для управления сущностями приложения;
    - На странице с объектами у объектов есть ссылка на поставщика;
    - Реализована фильтрация по названию города;
    - Реализован `admin action` очищающий задолженность перед поставщиком у выбранных объектов.

3. **набор API представлений**
    - CRUD представления для объектов сети и продукта;
    - Представление для получения информации обо всех объектах сети;
    - Представление для получения информации об объектах определённой страны (фильтр по названию);
    - Представление со статистикой об объектах, задолженность которых превышает среднюю задолженность всех объектов;
    - Представление для получения всех объектов сети, где можно встретить определенный продукт (фильтр по id продукта);
    - По запросу через API генерируется qr код с контактными данными объекта сети и отправляется на e-mail пользователя.

4. **Celery задачи**
    - Реализована задача, которая запускается автоматически каждые 3 часа и увеличивает задолженность перед поставщиком на случайное число от 5 до 500;
    - Реализована задача, которая запускается автоматически в 6:30 каждый день и уменьшать задолженность перед поставщиком на случайное число от 100 до 10 000;
    - Реализована задача, которая отправляет QR-код по электронной почте.


## Технологии
   - Проект разработан на языке программирования `Python` с использованием `Django REST framework`
   - Для работы с базой данных `PostgreSQL` используется сторонняя библиотека `psycopg`
   - В проекте подключена API документация при помощи библиотеки `drf-yasg`
   - Для управления виртуальным окружением используется инструмент `poetry`
   - Для взаимодействия с переменными окружения применяется библиотека `python-dotenv`
   - Для работы с задачи используется библиотека `celery`
   - Для генерации QR кодов используется библиотека `qrcode`
   - Для более простого запуска проекта применяется `Docker`

## Запуск проекта
### 1. Ручной запуск проекта:
   - Клонируйте репозиторий https://github.com/pavel-akulich/trading_network_platform
   - Установите все зависимости из файла `pyproject.toml`
   - В корне проекта создайте файл `.env` и скопируйте в него содержимое файла `.env.example`, указав необходимые значения (база данных, email сервер, настройки Celery)
   - Создайте базу данных и выполните миграции к базе данных `python3 manage.py migrate`
   - Для наполнения базы данных тестовыми данными выполните команду `python3 manage.py loaddata trading_network_data.json`
   - Запустите сервер `python3 manage.py runserver`
   - Для запуска Celery выполните команды `celery -A config worker -l INFO` и `celery -A config beat -l INFO`
   - Суперпользователь будет доступен под логином `example@example.com` и паролем `password123`. Остальные пользователи имеют этот же пароль.
### 2. Запуск проекта при помощи Docker:
   - Клонируйте репозиторий https://github.com/pavel-akulich/trading_network_platform
   - В корне проекта создайте файл `.env` и скопируйте в него содержимое файла `.env.example`, указав необходимые значения (база данных, email сервер, настройки Celery)
   - При помощи команды `docker compose up --build` соберите и запустите все сервисы
   - База данных создастся автоматически, после чего применятся миграции и база данных наполнится тестовыми данными из `trading_network_data.json`
   - После успешного выполнения предыдущего шага, приложение будет доступно по адресу http://127.0.0.1:8000/ или http://localhost:8000/
   - Суперпользователь будет доступен под логином `example@example.com` и паролем `password123`. Остальные пользователи имеют этот же пароль.

## API документация
После успешного локального запуска API документация будет доступна по следующим адресам: http://127.0.0.1:8000/openapi/ или http://127.0.0.1:8000/openapi/redoc/

## Примечания
   - Проект может быть доработан и расширен для более широкого использования
   - Переменные окружения, необходимые для работы проекта можно посмотреть в файле `.env.example`
   - Все необходимые зависимости находятся в файлах `pyproject.toml` и `poetry.lock`
